<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#ffffff">
    <title>投資收益管家</title>
    
    <!-- 1. 樣式庫 (Tailwind) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 2. 核心函式庫 (改用 cdnjs 較穩定) -->
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.10.3/Recharts.min.js"></script>
    
    <!-- 3. Babel 解析器 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <style>
        body { -webkit-tap-highlight-color: transparent; user-select: none; }
        .safe-top { padding-top: env(safe-area-inset-top); }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
        /* 隱藏捲軸但保留功能 */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- 啟動畫面 / 錯誤提示 -->
    <div id="loader" class="fixed inset-0 flex flex-col items-center justify-center bg-white z-50">
        <div class="w-10 h-10 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"></div>
        <p id="loader-text" class="text-slate-500 font-bold">正在啟動系統...</p>
        <p id="error-text" class="text-red-500 text-sm mt-2 hidden text-center px-4"></p>
        <button id="retry-btn" onclick="window.location.reload()" class="hidden mt-4 px-4 py-2 bg-slate-100 rounded text-slate-600">重試</button>
    </div>

    <!-- React 根目錄 -->
    <div id="root"></div>

    <!-- 系統檢查腳本 -->
    <script>
        // 檢查必要函式庫是否載入
        window.onload = function() {
            setTimeout(function() {
                const missing = [];
                if (!window.React) missing.push("React");
                if (!window.ReactDOM) missing.push("ReactDOM");
                if (!window.Recharts) missing.push("Recharts");
                
                if (missing.length > 0) {
                    document.getElementById('loader').querySelector('.animate-spin').style.display = 'none';
                    document.getElementById('loader-text').innerText = "啟動失敗";
                    document.getElementById('error-text').innerText = "無法載入必要元件 (" + missing.join(", ") + ")。\n請檢查網路連線後重試。";
                    document.getElementById('error-text').style.display = 'block';
                    document.getElementById('retry-btn').style.display = 'block';
                }
            }, 3000); // 3秒後檢查
        };
    </script>

    <!-- 主程式邏輯 -->
    <script type="text/babel">
        // 確保錯誤不會導致全白
        try {
            const { useState, useEffect, useMemo, useRef } = React;
            // 安全解構 Recharts，避免未載入時報錯
            const R = window.Recharts || {};
            const { AreaChart, Area, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ComposedChart, PieChart, Pie, Cell } = R;

            // --- Icons (使用 SVG 路徑，不依賴外部 icon font) ---
            const Icon = ({ d, size = 24, className = "", ...props }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>
                    {Array.isArray(d) ? d.map((p, i) => <path key={i} d={p} />) : <path d={d} />}
                </svg>
            );
            
            // 簡易圖示定義
            const ICONS = {
                TrendingUp: <polyline points="23 6 13.5 15.5 8.5 10.5 1 18 17 6 23 6 23 12" />, // Polyline workaround
                Menu: "M3 12h18M3 6h18M3 18h18",
                Plus: "M12 5v14M5 12h14",
                Trash: "M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2",
                Save: "M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z",
                Settings: "M12 15a3 3 0 100-6 3 3 0 000 6z M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z",
                Chart: "M18 20V10M12 20V4M6 20v-6",
                Pie: "M21.21 15.89A10 10 0 118 2.83M22 12A10 10 0 0012 2v10z",
                Download: "M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3",
                Upload: "M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12",
                Eye: "M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z M12 9a3 3 0 100 6 3 3 0 000-6z",
                EyeOff: "M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24 M1 1l22 22",
                Sparkles: "M12 3l-1.9 5.8a2 2 0 01-1.3 1.3L3 12l5.8 1.9a2 2 0 011.3 1.3L12 21l1.9-5.8a2 2 0 011.3-1.3L21 12l-5.8-1.9a2 2 0 01-1.3-1.3L12 3z"
            };

            // --- UI Components ---
            const Btn = ({ children, onClick, className="", variant="primary" }) => {
                const base = "px-4 py-2 rounded-lg font-medium transition active:scale-95 flex items-center justify-center gap-2";
                const styles = {
                    primary: "bg-blue-600 text-white shadow-md hover:bg-blue-700",
                    secondary: "bg-slate-200 text-slate-700 hover:bg-slate-300",
                    danger: "bg-red-50 text-red-600 border border-red-100",
                    outline: "border border-slate-300 text-slate-600",
                    ghost: "text-slate-500 hover:bg-slate-100"
                };
                return <button onClick={onClick} className={`${base} ${styles[variant]} ${className}`}>{children}</button>;
            };

            const App = () => {
                // --- States ---
                const [activeTab, setActiveTab] = useState('dashboard');
                const [accounts, setAccounts] = useState(() => {
                    try { return JSON.parse(localStorage.getItem('inv_accounts')) || [{ id: 'a1', name: '帳號 A', color: '#3b82f6' }]; } catch { return [{ id: 'a1', name: '帳號 A', color: '#3b82f6' }]; }
                });
                const [records, setRecords] = useState(() => {
                    try { return JSON.parse(localStorage.getItem('inv_records')) || []; } catch { return []; }
                });
                const [settings, setSettings] = useState(() => {
                    try { return JSON.parse(localStorage.getItem('inv_settings')) || { benchmarkName: '台股加權指數', apiKey: '' }; } catch { return {}; }
                });
                
                const [inputDate, setInputDate] = useState(new Date().toISOString().split('T')[0]);
                const [inputAcc, setInputAcc] = useState(accounts[0]?.id);
                const [inputValue, setInputValue] = useState('');
                const [inputFlow, setInputFlow] = useState('');
                const [inputBench, setInputBench] = useState('');
                const [isPrivacy, setIsPrivacy] = useState(false);
                const [toast, setToast] = useState(null);
                const [modal, setModal] = useState(null); // 'ai', 'backup'

                // --- Effects ---
                useEffect(() => { localStorage.setItem('inv_accounts', JSON.stringify(accounts)); }, [accounts]);
                useEffect(() => { localStorage.setItem('inv_records', JSON.stringify(records)); }, [records]);
                useEffect(() => { localStorage.setItem('inv_settings', JSON.stringify(settings)); }, [settings]);
                
                // Hide Loader
                useEffect(() => { document.getElementById('loader').style.display = 'none'; }, []);

                // --- Helpers ---
                const showMsg = (txt) => { setToast(txt); setTimeout(() => setToast(null), 3000); };
                const fmtNum = (n) => isPrivacy ? '****' : new Intl.NumberFormat('zh-TW', { maximumFractionDigits: 0 }).format(n);
                const fmtPct = (n) => `${n > 0 ? '+' : ''}${n?.toFixed(2)}%`;

                // --- Calculations ---
                const sortedRecs = useMemo(() => [...records].sort((a,b) => new Date(a.date) - new Date(b.date)), [records]);
                
                const stats = useMemo(() => {
                    let totalVal = 0, totalInv = 0;
                    const accs = accounts.map(a => {
                        const rs = sortedRecs.filter(r => r.accountId === a.id);
                        if(rs.length === 0) return { ...a, val: 0, roi: 0 };
                        const last = rs[rs.length-1];
                        const inv = (parseFloat(rs[0].marketValue) - parseFloat(rs[0].cashFlow)) + rs.reduce((s,r) => s + parseFloat(r.cashFlow), 0);
                        const val = parseFloat(last.marketValue);
                        totalVal += val; totalInv += inv;
                        return { ...a, val, roi: inv?((val-inv)/inv)*100:0 };
                    });
                    return { accs, totalVal, totalInv, totalRoi: totalInv?((totalVal-totalInv)/totalInv)*100:0 };
                }, [accounts, sortedRecs]);

                const chartData = useMemo(() => {
                    if(sortedRecs.length === 0) return [];
                    const dates = [...new Set(sortedRecs.map(r => r.date))].sort();
                    const initBench = parseFloat(sortedRecs.find(r=>r.benchmarkValue)?.benchmarkValue || 0);
                    
                    return dates.map(d => {
                        const dayRecs = sortedRecs.filter(r => r.date <= d);
                        let dayVal = 0, dayInv = 0;
                        accounts.forEach(a => {
                            const rs = dayRecs.filter(r => r.accountId === a.id);
                            if(rs.length > 0) {
                                const l = rs[rs.length-1];
                                dayVal += parseFloat(l.marketValue);
                                dayInv += (parseFloat(rs[0].marketValue) - parseFloat(rs[0].cashFlow)) + rs.reduce((s,r) => s + parseFloat(r.cashFlow), 0);
                            }
                        });
                        const bRec = dayRecs.filter(r=>r.date===d && r.benchmarkValue).pop();
                        const bVal = bRec ? parseFloat(bRec.benchmarkValue) : null;
                        return { 
                            date: d, 
                            val: dayVal, 
                            roi: dayInv ? ((dayVal-dayInv)/dayInv)*100 : 0,
                            bench: bVal,
                            benchRoi: (initBench && bVal) ? ((bVal-initBench)/initBench)*100 : null
                        };
                    });
                }, [sortedRecs, accounts]);

                // --- Handlers ---
                const handleAdd = () => {
                    if(!inputValue) return showMsg("請輸入金額");
                    const newRec = {
                        id: Date.now(),
                        date: inputDate,
                        accountId: inputAcc || accounts[0].id,
                        marketValue: parseFloat(inputValue),
                        cashFlow: parseFloat(inputFlow) || 0,
                        benchmarkValue: benchmarkInput
                    };
                    setRecords(prev => {
                        const exist = prev.findIndex(r => r.date === newRec.date && r.accountId === newRec.accountId);
                        if(exist >= 0) { const n=[...prev]; n[exist]=newRec; return n; }
                        return [...prev, newRec];
                    });
                    setInputValue(''); setInputFlow(''); showMsg("已儲存");
                };

                const handleBackup = () => {
                    const data = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify({accounts, records, settings}));
                    const a = document.createElement('a'); a.href = data; a.download = `backup_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                };

                const handleRestore = (e) => {
                    const reader = new FileReader();
                    reader.onload = (evt) => {
                        try {
                            const d = JSON.parse(evt.target.result);
                            if(d.accounts && d.records) { setAccounts(d.accounts); setRecords(d.records); if(d.settings) setSettings(d.settings); showMsg("還原成功"); }
                        } catch { showMsg("檔案錯誤"); }
                    };
                    if(e.target.files[0]) reader.readAsText(e.target.files[0]);
                };

                const handleDemo = () => {
                    if(!confirm("這將清除現有資料，確定嗎？")) return;
                    // 生成 10 年模擬資料
                    const newRecs = [];
                    let v = 1000000, b = 10000;
                    let d = new Date(); d.setFullYear(d.getFullYear() - 10);
                    for(let i=0; i<3650; i++) {
                        v *= (1 + (Math.random()*0.03 - 0.014));
                        b *= (1 + (Math.random()*0.025 - 0.012));
                        if(i%30===0) newRecs.push({
                            id: `demo_${i}`, date: d.toISOString().split('T')[0],
                            accountId: accounts[0].id, marketValue: Math.round(v), cashFlow: 0, benchmarkValue: Math.round(b)
                        });
                        d.setDate(d.getDate()+1);
                    }
                    setRecords(newRecs); showMsg("模擬資料已生成"); setActiveTab('dashboard');
                };

                // --- Render ---
                return (
                    <div className="pb-24 max-w-lg mx-auto">
                        {toast && <div className="fixed top-4 left-1/2 -translate-x-1/2 bg-slate-800 text-white px-4 py-2 rounded-full shadow-lg z-50 text-sm">{toast}</div>}
                        
                        <div className="sticky top-0 bg-white border-b border-slate-100 z-10 px-4 py-3 flex justify-between items-center safe-top">
                            <h1 className="text-lg font-bold text-slate-800 flex items-center gap-2">
                                <span className="bg-blue-600 text-white p-1 rounded"><Icon d={ICONS.TrendingUp} size={18}/></span> 投資管家
                            </h1>
                            <button onClick={()=>setIsPrivacy(!isPrivacy)} className="text-slate-400">
                                <Icon d={isPrivacy ? ICONS.EyeOff : ICONS.Eye} />
                            </button>
                        </div>

                        <div className="p-4 space-y-6">
                            {activeTab === 'dashboard' && (
                                <div className="space-y-4 animate-fade-in">
                                    <div className="grid grid-cols-2 gap-4">
                                        <Card className="p-4 border-l-4 border-blue-500">
                                            <div className="text-xs text-slate-500 mb-1">總市值</div>
                                            <div className="text-xl font-bold">{fmtNum(stats.totalVal)}</div>
                                        </Card>
                                        <Card className={`p-4 border-l-4 ${stats.totalRoi>=0?'border-red-500':'border-green-500'}`}>
                                            <div className="text-xs text-slate-500 mb-1">總報酬率</div>
                                            <div className={`text-xl font-bold ${stats.totalRoi>=0?'text-red-600':'text-green-600'}`}>{fmtPct(stats.totalRoi)}</div>
                                        </Card>
                                    </div>

                                    {chartData.length > 0 ? (
                                        <Card className="p-4 h-64">
                                            <div className="text-sm font-bold mb-4 flex items-center gap-2 text-slate-700"><Icon d={ICONS.Chart} size={16}/> 資產走勢 (10年)</div>
                                            <ResponsiveContainer width="100%" height="100%">
                                                <AreaChart data={chartData}>
                                                    <defs><linearGradient id="colorVal" x1="0" y1="0" x2="0" y2="1"><stop offset="5%" stopColor="#3b82f6" stopOpacity={0.1}/><stop offset="95%" stopColor="#3b82f6" stopOpacity={0}/></linearGradient></defs>
                                                    <XAxis dataKey="date" hide />
                                                    <YAxis domain={['auto','auto']} hide />
                                                    <Tooltip labelStyle={{color:'#666'}} formatter={(v)=>fmtNum(v)} contentStyle={{borderRadius:'8px', border:'none', boxShadow:'0 4px 12px rgba(0,0,0,0.1)'}}/>
                                                    <Area type="monotone" dataKey="val" stroke="#3b82f6" fill="url(#colorVal)" strokeWidth={2} />
                                                </AreaChart>
                                            </ResponsiveContainer>
                                        </Card>
                                    ) : (
                                        <div className="text-center py-10 text-slate-400 bg-white rounded-xl border border-dashed">尚無數據，請先記帳</div>
                                    )}

                                    <div className="space-y-3">
                                        {stats.accs.map(a => (
                                            <Card key={a.id} className="p-4 flex justify-between items-center">
                                                <div>
                                                    <div className="font-bold text-slate-800 flex items-center gap-2">
                                                        <span className="w-3 h-3 rounded-full" style={{backgroundColor:a.color}}></span>{a.name}
                                                    </div>
                                                    <div className="text-xs text-slate-400 mt-1">市值: {fmtNum(a.val)}</div>
                                                </div>
                                                <div className={`font-bold ${a.roi>=0?'text-red-500':'text-green-500'}`}>{fmtPct(a.roi)}</div>
                                            </Card>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {activeTab === 'input' && (
                                <Card className="p-5 space-y-4 animate-fade-in">
                                    <h2 className="font-bold text-slate-800 mb-2">新增紀錄</h2>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div><label className="text-xs text-slate-500">日期</label><input type="date" value={entryDate} onChange={e=>setEntryDate(e.target.value)} className="w-full border rounded p-2 mt-1"/></div>
                                        <div><label className="text-xs text-slate-500">帳號</label><select value={inputAcc} onChange={e=>setInputAcc(e.target.value)} className="w-full border rounded p-2 mt-1 bg-white">{accounts.map(a=><option key={a.id} value={a.id}>{a.name}</option>)}</select></div>
                                    </div>
                                    <div><label className="text-xs text-slate-500">總市值 ($)</label><input type="number" value={inputValue} onChange={e=>setInputValue(e.target.value)} placeholder="輸入當下總價值" className="w-full border rounded p-2 mt-1 text-lg"/></div>
                                    <div><label className="text-xs text-slate-500">大盤指數 (選填)</label><input type="number" value={benchmarkInput} onChange={e=>setBenchmarkInput(e.target.value)} placeholder="例如 20000" className="w-full border rounded p-2 mt-1"/></div>
                                    <div className="pt-2 border-t border-slate-100">
                                        <label className="text-xs text-slate-500 mb-2 block">資金流向 (存錢/領錢才填)</label>
                                        <div className="flex gap-2 mb-2">
                                            <button onClick={()=>setFlowType('deposit')} className={`flex-1 py-1 text-sm rounded ${flowType==='deposit'?'bg-blue-600 text-white':'bg-slate-100 text-slate-600'}`}>存入 (+)</button>
                                            <button onClick={()=>setFlowType('withdraw')} className={`flex-1 py-1 text-sm rounded ${flowType==='withdraw'?'bg-orange-500 text-white':'bg-slate-100 text-slate-600'}`}>領出 (-)</button>
                                            <button onClick={()=>{setFlowType('none'); setInputFlow('')}} className={`flex-1 py-1 text-sm rounded ${flowType==='none'?'bg-slate-800 text-white':'bg-slate-100 text-slate-600'}`}>無</button>
                                        </div>
                                        {flowType !== 'none' && <input type="number" value={inputFlow} onChange={e=>setInputFlow(e.target.value)} placeholder="金額" className="w-full border rounded p-2"/>}
                                    </div>
                                    <Button onClick={handleAdd} className="w-full py-3 text-lg mt-2">儲存紀錄</Button>
                                </Card>
                            )}

                            {activeTab === 'records' && (
                                <div className="space-y-3 animate-fade-in">
                                    {sortedRecs.slice().reverse().map(r => (
                                        <div key={r.id} className="bg-white p-3 rounded-lg border border-slate-100 flex justify-between items-center shadow-sm">
                                            <div>
                                                <div className="text-sm font-bold text-slate-700">{r.date}</div>
                                                <div className="text-xs text-slate-400 mt-1 flex gap-2">
                                                    <span className="bg-slate-100 px-1 rounded text-slate-600">{accounts.find(a=>a.id===r.accountId)?.name}</span>
                                                    {r.cashFlow !== 0 && <span className={r.cashFlow>0?'text-blue-500':'text-orange-500'}>{r.cashFlow>0?'存':'領'} {r.cashFlow}</span>}
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-3">
                                                <div className="font-mono font-medium">{fmtNum(r.marketValue)}</div>
                                                <button onClick={()=>setRecords(prev=>prev.filter(x=>x.id!==r.id))} className="text-slate-300 hover:text-red-500"><Icon d={ICONS.Trash} size={18}/></button>
                                            </div>
                                        </div>
                                    ))}
                                    {records.length === 0 && <div className="text-center text-slate-400 mt-10">尚無紀錄</div>}
                                </div>
                            )}

                            {activeTab === 'settings' && (
                                <div className="space-y-4 animate-fade-in">
                                    <Card className="p-4">
                                        <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2"><Icon d={ICONS.Settings} size={18}/> 資料管理</h3>
                                        <div className="grid grid-cols-2 gap-3">
                                            <Button variant="outline" onClick={handleBackup}><Icon d={ICONS.Download} size={16}/> 備份檔案</Button>
                                            <div className="relative">
                                                <input type="file" onChange={handleRestore} className="absolute inset-0 opacity-0 w-full h-full cursor-pointer" />
                                                <Button variant="outline" className="w-full"><Icon d={ICONS.Upload} size={16}/> 還原檔案</Button>
                                            </div>
                                        </div>
                                    </Card>
                                    <Card className="p-4 border-l-4 border-amber-400">
                                        <h3 className="font-bold text-slate-800 mb-2 flex items-center gap-2"><Icon d={ICONS.Sparkles} size={18} className="text-amber-500"/> 測試功能</h3>
                                        <Button variant="ghost" onClick={handleDemo} className="w-full border border-amber-200 text-amber-700 bg-amber-50">生成 10 年模擬資料</Button>
                                    </Card>
                                    <div className="text-center text-xs text-slate-300 mt-8">Investment Tracker v2.1</div>
                                </div>
                            )}
                        </div>

                        {/* Bottom Nav */}
                        <div className="fixed bottom-0 w-full bg-white border-t border-slate-200 flex justify-around py-3 pb-6 safe-bottom z-30">
                            {[
                                {id:'dashboard', label:'儀表板', icon:ICONS.Chart},
                                {id:'input', label:'記帳', icon:ICONS.Plus},
                                {id:'records', label:'明細', icon:ICONS.Menu},
                                {id:'settings', label:'設定', icon:ICONS.Settings}
                            ].map(t => (
                                <button 
                                    key={t.id} 
                                    onClick={()=>setActiveTab(t.id)} 
                                    className={`flex flex-col items-center gap-1 text-xs ${activeTab===t.id ? 'text-blue-600 font-bold' : 'text-slate-400'}`}
                                >
                                    <Icon d={t.icon} size={24} strokeWidth={activeTab===t.id?2.5:2} />
                                    {t.label}
                                </button>
                            ))}
                        </div>
                    </div>
                );
            };

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        
        } catch (err) {
            console.error(err);
            document.getElementById('loader').innerHTML = '<p class="text-red-500 px-4 text-center">初始化失敗：' + err.message + '</p>';
        }
    </script>
</body>
</html>

